# GitHub Copilot Instructions - SignalTrust AI Scanner

> Quick context file for AI assistants working on this project

## üéØ Project Type
AI-powered financial market analysis platform with Flask backend and multi-agent architecture

## üèóÔ∏è Tech Stack
- **Backend**: Python 3.7+, Flask
- **AI**: OpenAI GPT-4, Anthropic Claude, Ollama (local)
- **Multi-Agent**: CrewAI, Docker, FastAPI
- **Frontend**: HTML, CSS, JavaScript (Vanilla)
- **Data**: JSON file storage, SQLite for transactions
- **APIs**: CoinGecko, Alpha Vantage, WhaleAlert, NewsCatcher

## üì¶ Core Modules

### Main Application
- `app.py` - Flask app, routes, API endpoints
- `market_scanner.py` - Real-time market scanning
- `market_analyzer.py` - Technical analysis
- `ai_predictor.py` - ML predictions
- `ai_provider.py` - AI model management (OpenAI/Anthropic/Local)
- `user_auth.py` - Authentication, password hashing
- `payment_processor.py` - Subscription & payment handling

### Multi-Agent System (Docker)
- `agents/coordinator/` - CrewAI orchestrator (Port 8000)
- `agents/crypto_agent/` - Crypto analysis (Port 8001)
- `agents/stock_agent/` - Stock analysis (Port 8002)
- `agents/whale_agent/` - Whale watching (Port 8003)
- `agents/news_agent/` - News aggregation (Port 8004)

## üé® Code Style

### Python
```python
# PEP 8 compliant
# snake_case for functions/variables
# PascalCase for classes
# Type hints preferred

def analyze_market(symbol: str, timeframe: str = "1d") -> dict:
    """Docstring with Args and Returns."""
    pass
```

### Error Handling
```python
try:
    result = operation()
except SpecificError as e:
    logger.error(f"Error: {str(e)}")
    return {"success": False, "error": str(e)}
```

## üîí Security Patterns
- PBKDF2-HMAC-SHA256 for passwords (100k iterations)
- Session-based auth (no JWT)
- Luhn algorithm for card validation
- XSS/CSRF protection in templates
- Secrets in `.env` (never commit)

## üìÅ File Structure
```
/templates/         # Jinja2 HTML templates
/static/           # CSS, JS, images
/data/             # User/transaction JSON files
/agents/           # Docker-based multi-agent system
/config/           # Configuration files
*.py               # Python modules in root
```

## üöÄ Common Commands
```bash
# Start app
./start.sh          # Linux/Mac
python3 start.py    # Cross-platform

# Multi-agent system
./setup_agents.sh   # Setup & start agents
make up            # Docker compose up
make logs          # View logs

# Testing
python3 test_complete_system.py
python3 test_ai_system.py
```

## üîå API Patterns

### Flask Routes
```python
@app.route('/api/resource', methods=['POST'])
def handle_resource():
    data = request.get_json()
    # Validate input
    # Process
    return jsonify({"success": True, "data": result})
```

### Multi-Agent Communication
```python
import requests
response = requests.post(
    'http://localhost:8001/predict',
    json={"symbol": "BTC", "timeframe": "1d"}
)
```

## üìä Data Models

### User Object
```python
{
    "user_id": "user_123",
    "email": "user@example.com",
    "password_hash": "...",
    "salt": "...",
    "plan": "pro",  # free, basic, pro, enterprise
    "created_at": "2026-02-08T00:00:00"
}
```

### Market Analysis Result
```python
{
    "symbol": "AAPL",
    "price": 150.25,
    "change_24h": 2.5,
    "indicators": {
        "rsi": 65.2,
        "macd": 1.23,
        "sma_50": 148.5
    },
    "prediction": {
        "direction": "up",
        "confidence": 0.85
    }
}
```

## üîë Environment Variables
```bash
# AI Providers
OPENAI_API_KEY=sk-proj-...
OPENAI_MODEL=gpt-4
AI_PROVIDER=openai  # or anthropic, local

# Market Data APIs
COINGECKO_API_KEY=...
ALPHA_VANTAGE_API_KEY=...

# App Config
PORT=5000
DEBUG=False
```

## ‚ö° Quick Tips

### When adding features:
1. Check if similar code exists (DRY principle)
2. Follow existing patterns in the module
3. Add error handling for API calls
4. Log important operations
5. Update relevant documentation

### When fixing bugs:
1. Check `data/` folder for user data issues
2. Review logs for error traces
3. Test with default admin account (signaltrustai@gmail.com)
4. Verify API key configurations in `.env`

### When working with AI:
1. Use `ai_provider.py` for all AI calls
2. Handle fallback when AI unavailable
3. Cache expensive predictions
4. Rate limit AI requests per user plan

## üìñ Key Files to Reference
- `README.md` - Full project overview
- `ARCHITECTURE.md` - System architecture
- `MULTI_AGENT_SYSTEM.md` - Agent system details
- `OPENAI_SETUP_GUIDE.md` - AI setup instructions
- `AI_COPILOT_GUIDE.md` - Full collaboration guide

## üß™ Testing
- Unit tests: `test_*.py` files
- Integration tests: `test_complete_system.py`
- Agent tests: `./test_agents.sh`
- Always test authentication flows
- Verify payment processing in test mode

## üêõ Common Issues & Solutions

### "OpenAI API Error"
‚Üí Check `OPENAI_API_KEY` in `.env`

### "Agent not responding"
‚Üí Run `docker-compose ps` to check status

### "Import error"
‚Üí Run `pip install -r requirements.txt`

### "Permission denied"
‚Üí Run `chmod +x start.sh setup_agents.sh`

---

**Remember**: This is a financial application - prioritize security, data validation, and error handling!
